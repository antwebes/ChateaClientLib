<html>
    <head>
        <script
            type="text/javascript"
            src="../../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Created by Javier Fern&aacute;ndez Rodr&iacute;guez
 * User: jjbier@gmail.com
 * Date: 9/10/13
 * Time: 9:49
 * To change this template use File | Settings | File Templates.
 */
namespace Ant\ChateaClient\Service\Client;

use Guzzle\Common\Collection;
use Ant\Guzzle\Plugin\OAuth2Plugin;
use Ant\Guzzle\Plugin\AcceptHeaderPluging;

/**
 * A ChateaGratis API client
 */
class ChateaGratisClient extends Client
{
    /**
     * @var \Ant\Guzzle\Plugin\OAuth2Plugin
     */
    private $_OAuth2Plugin;

    public static function factory($config = array())
    {
        // Provide a hash of default client configuration options
        $default = array(
                'base_url'=&gt;'{scheme}://{subdomain}.chateagratis.local',
                'token_format'=&gt;'Bearer',
                'Accept'=&gt;'application/json',
                'environment'=&gt;'prod',
                'scheme' =&gt; 'https',
                'version'=&gt;'',
                'subdomain'=&gt;'api',
                'service-description-name' =&gt; Client::NAME_SERVICE_API
                );

        $required = array(
            'base_url',
            'scheme',
            'subdomain',
            'token_format',
            'access_token',
            'Accept',
            'environment',
        );

        // Merge in default settings and validate the config
        $config = Collection::fromConfig($config, $default, $required);

        if($config['environment'] == 'dev' ){

            $config['base_url'] = $config['base_url'] . '/app_dev.php';
            $config['scheme'] = 'http';
            $config['ssl.certificate_authority'] = 'system';
            $config['curl.options'] = array(CURLOPT_SSL_VERIFYHOST=&gt;false,CURLOPT_SSL_VERIFYPEER=&gt;false);
        }

        // Create a new ChateaGratis client
        $client = new self($config-&gt;get('base_url'),
                           $config-&gt;get('scheme'),
                           $config-&gt;get('subdomain'),
                           $config
        );


        $client-&gt;_OAuth2Plugin = new OAuth2Plugin($config-&gt;toArray());

        // Ensure that the Oauth2Plugin is attached to the client
        $client-&gt;addSubscriber($client-&gt;_OAuth2Plugin);

        $client-&gt;addSubscriber(new AcceptHeaderPluging($config-&gt;toArray()));

        return $client;
    }

    public function updateAccessToken($acces_token)
    {
        $this-&gt;_OAuth2Plugin-&gt;updateAccessToken($acces_token);
    }
}</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>